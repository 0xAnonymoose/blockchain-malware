---
version: 1
malwareName: "Rugpull.aifjoanvls"
malwareTags:
  - "backdoor.mint"
blockchain:
  id: 56
  name: "BSC"

signatures:
  - signatureType: "transaction"
    note: "Funder wallet creates puppet deployers"
    filter:
      from: "0xd93408ffe8027430bcf7b4151d0c036fd614de33"
      value: "2200000000000000000"
    outputSchema: "puppet"
    outputMap:
      puppetCreated: "to"
      puppetMaster: "from"
    example:
      - transactionHash: "0xe015de2312ad1426c9b4b4dea1c000c849007b0c9d6105bb8969bba1322ec440"
        detectedSchema: "puppet"
        puppetCreated: "0xf44855be396466c5f8867c01621a6c326052a729"
        puppetMaster: "0xd93408ffe8027430bcf7b4151d0c036fd614de33"
      - transactionHash: "0x7673c675f86216405708b8edfa1a29b7618fdb252cabe52dfd61d936410ee64f"
        detectedSchema: "puppet"
        puppetCreated: "0x34224299a0e512ac5d30c646424bb221e989a1ad"
        puppetMaster: "0xd93408ffe8027430bcf7b4151d0c036fd614de33"
                       
  - signatureType: "transaction"
    note: "Rugpull contract deploy check"
    filter:
      to: null
      input:
        length: 46617
        hashOffset: 5680
        hashLength: 40832
        checksum: "dbcfa455e4929ba584260f5f5e04294c6f05ce33e099dc50e218ae940aaac9dc"
    outputSchema: "malware"
    outputMap:
      malwareContract: "contractAddress"
      malwareDeployer: "from"
    example:
      - transactionHash: "0x896be5e7ba3bb6041e698a8e83ad49cea947f5f6e631033ccc225b46b3bc951f"
        detectedSchema: "malware"
        malwareContract: "0x7fa1a7b22c9b45a1f3c7f354f797a9294f352816"
        malwareDeployer: "0xd93408ffe8027430bcf7b4151d0c036fd614de33"
      - transactionHash: "0xb09c6caabf46ade9845e513e9a446f35bf86e9ff97278e6a5d5b73ed558d7f45"
        detectedSchema: "malware"
        malwareContract: "0xe21bba7bb966644248cbf4415241a49d242bdc63"
        malwareDeployer: "0x34224299a0e512ac5d30c646424bb221e989a1ad"

  - signatureType: "contract"
    note: "Rugpull contract runtime check"
    filter:
      code:
        length: 37345
        hashOffset: 0
        hashLength: 37232
        checksum: "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
    outputSchema: "malware"
    example:
      - detectedSchema: "malware"
        contractAddress: "0x7fa1a7b22c9b45a1f3c7f354f797a9294f352816"
      - detectedSchema: "malware"
        contractAddress: "0xe21bba7bb966644248cbf4415241a49d242bdc63"
                
samples:
  KibaShitama.sol:
    sampleType: "solidity"
    modified: false
    uri: "https://bscscan.com/address/0x7fa1a7b22c9b45a1f3c7f354f797a9294f352816#code"
    length: 28178
    sha256: "f35f1c239fa58c5bd8262129254745d4cbd6ae64e6b459161b8b135f311ec78e"
  Pikatama.sol:
    sampleType: "solidity"
    modified: false
    uri: "https://bscscan.com/address/0xe21bba7bb966644248cbf4415241a49d242bdc63#code"
    length: 28115
    sha256: "2710e854f5941a4607a0d656f510cd37bf4873ec8390c91f22f37db01fc3fe36"    
  KibaShitama-evm.hex:
    sampleType: "code"
    modified: false
    contract: "0x7fa1a7b22c9b45a1f3c7f354f797a9294f352816"
    transactionHash: "0x896be5e7ba3bb6041e698a8e83ad49cea947f5f6e631033ccc225b46b3bc951f"
    length: 37345    
    sha256: "c330a4a9155ff8494eb84ac21325f5e5d9b7fc5f5ee5dd8aa3cbeb7df80beed4"
  KibaShitama-input.hex:
    sampleType: "input"
    modified: false
    contract: "0x7fa1a7b22c9b45a1f3c7f354f797a9294f352816"
    transactionHash: "0x896be5e7ba3bb6041e698a8e83ad49cea947f5f6e631033ccc225b46b3bc951f"
    length: 46617    
    sha256: "07bad4c5e40aa6e4457e2d740d0a176b1178ddb33aba3df28e04a2cf7fda1425"
  Pikatama-evm.hex:
    sampleType: "evm"
    modified: false
    contract: "0xe21bba7bb966644248cbf4415241a49d242bdc63"
    transactionHash: "0xb09c6caabf46ade9845e513e9a446f35bf86e9ff97278e6a5d5b73ed558d7f45"
    length: 37345    
    sha256: "3157336116efe2c8fe7f55af600bd80ba742ff900a126b0ca97e622392ba18a1"
  Pikatama-input.hex:
    sampleType: "input"
    modified: false
    contract: "0xe21bba7bb966644248cbf4415241a49d242bdc63"
    transactionHash: "0xb09c6caabf46ade9845e513e9a446f35bf86e9ff97278e6a5d5b73ed558d7f45"
    length: 46617
    sha256: "556add48a35beb5cbbdb767b6d7eef7ee6034ec5f81ea81121b511fa93100883"
  KibaShitama.$bep20:
    sampleType: "bep20"
    name: "KibaShitama"
    symbol: "KBS"
    contract: "0x7fa1a7b22c9b45a1f3c7f354f797a9294f352816"    
    wallet:
       team: "0xf44855BE396466C5F8867c01621A6C326052A729"
       marketing: "0xf44855BE396466C5F8867c01621A6C326052A729"
       deployer: "0xf44855BE396466C5F8867c01621A6C326052A729"
       funder: "0xd93408ffe8027430bcf7b4151d0c036fd614de33"
    social:
       telegram: "https://t.me/KibaShitamaInu"
  Pikatama.$bep20:
    sampleType: "bep20"
    name: "Pikatama"
    symbol: "PIKATAMA"
    contract: "0xe21bba7bb966644248cbf4415241a49d242bdc63"    
    wallet:
       team: "0x34224299A0e512aC5d30c646424bb221E989a1Ad"
       marketing: "0x34224299A0e512aC5d30c646424bb221E989a1Ad"
       deployer: "0x34224299A0e512aC5d30c646424bb221E989a1Ad"
       funder: "0xd93408ffe8027430bcf7b4151d0c036fd614de33"
    social:
       telegram: "https://t.me/Pikatama"
       
annotations:
  - sample: "KibaShitama.sol"
    lines: [[7, 8]]
    text: "Not technically a lie, but practically the deployer can mint more any time."
  - sample: "KibaShitama.sol"
    lines: [399, [475, 476]]
    text: "The taxExempt storage has been renamed aifjoanvls in this malware (hence the name) and is used as a permission-gate for the unlimited mint backdoor.  Note that deployer grants themselves this permission in the constructor"
  - sample: "KibaShitama.sol"
    lines: [[501-503]]
    text: "The balances storage has been renamed _KsawBAwsl in this malware"
  - sample: "KibaShitama.sol"
    annotationType: "backdoor.mint"
    lines: [[676,679]]    
    text: "setSwapAndLiquifyByLimitOnIy (note the capital I in place of L) is the backdoor mint function used by attacker to Rugpull.  If the caller has permission (see note above, granted at mint time in the constuctor) this function will backdoor the given balance into the given wallet."
  
  
