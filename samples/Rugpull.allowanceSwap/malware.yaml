---
version: 1
malwareName: "Rugpull.allowanceSwap"
malwareTags:
  - "backdoor.mint"
blockchain:
  id: 56
  name: "BSC"

signatures:

  - signatureType: "transaction"
    note: "Rugpull contract backdoor mint"
    filter:
      input:
        startsWith: "0xe5f8e253"
    outputSchema: "backdoorMint"
    outputMap:
      malwareContract: "to"
      malwareDeployer: "from"
    example:
      - transactionHash: "0xfacda82b93c63cfa69d722879406570ec0a1adb884c257996341d13dafacea1f"
        detectedSchema: "backdoorMint"
        malwareContract: ""
        malwareDeployer: ""

  - signatureType: "contract"
    note: "Rugpull contract runtime check"
    filter:
      code:
        length: 
        hashOffset: 0
        hashLength: 
        checksum: ""
    outputSchema: "malware"
    example:
      - detectedSchema: "malware"
        contractAddress: "0x0f049af1ce260ae896c339799d586f8b803bba5b"
        transactionHash: "0x94109a6794c7acae67ad9202863e146873b5a6d1e04c6b3826a61e165c91e953"

  - signatureType: "source"
    keyword: "rownerd[pancakeswaprooter]"
    note: "Backdoored mint function method"
    
samples:
  EthereumSquid.sol:
    sampleType: "solidity"
    modified: false
    uri: "https://bscscan.com/address/0x0f049af1ce260ae896c339799d586f8b803bba5b#code"
    contract: "0x0f049af1ce260ae896c339799d586f8b803bba5b"
    length: 7774
    sha256: ""
    
  EthereumSquid-evm.hex:
    sampleType: "code"
    modified: false
    contract: "0x0f049af1ce260ae896c339799d586f8b803bba5b"
    transactionHash: "0x94109a6794c7acae67ad9202863e146873b5a6d1e04c6b3826a61e165c91e953"
    length: 6000
    sha256: ""
      
  EthereumSquid.$bep20:
    sampleType: "bep20"
    name: "EthereumSquid"
    symbol: "EthereumSquid"
    contract: "0x0f049af1ce260ae896c339799d586f8b803bba5b"    
    wallet:
       deployer: "0x6eddfa7b5a2f0828aaf95afc344916e5ac63b0b8"
    social:
       telegram: "https://t.me/EthereumSquid"
       
annotations:
  - sample: "EthereumSquid.sol"
    lines: [134]
    text: "PILOTWALL stores attacker address."
  - sample: "EthereumSquid.sol"
    lines: [[163,156]]
    text: "_virtual ensures only attacker can call a method"
  - sample: "EthereumSquid.sol"
    annotationType: "backdoor.mint"  
    lines: [[193,195]]
    text: "allowanceSwap is the unbounded mint backdoor, protected by _virtual"

  
